language: php
sudo: true
php:
- 5.6

cache:
  bundler: true
  apt: true#
  directories:
  - "$HOME/.composer/cache"
  - "$HOME/.drush/cache"

matrix:
  fast_finish: true
env:
  global:
  - PATH="$PATH:$HOME/.composer/vendor/bin"
  - DRUPAL_TI_MODULE_NAME="scheduler"
  - DRUPAL_TI_SIMPLETEST_GROUP="Scheduler"
  - DRUPAL_TI_ENVIRONMENT="drupal-7"
  - DRUPAL_TI_DB="drupal_travis_db"
  - DRUPAL_TI_DB_URL="mysql://root:@127.0.0.1/drupal_travis_db"
  - DRUPAL_TI_WEBSERVER_URL="http://127.0.0.1"
  - DRUPAL_TI_WEBSERVER_PORT="8080"
  - DRUPAL_TI_SIMPLETEST_ARGS="--verbose --color --concurrency 4 --url $DRUPAL_TI_WEBSERVER_URL:$DRUPAL_TI_WEBSERVER_PORT"
  - DRUPAL_TI_BEHAT_DIR="./tests/behat"
  - DRUPAL_TI_BEHAT_ARGS=""
  - DRUPAL_TI_BEHAT_YML="behat.yml.dist"
  - DRUPAL_TI_BEHAT_SCREENSIZE_COLOR="1280x1024x16"
  - DRUPAL_TI_BEHAT_SELENIUM_VERSION="2.48.2"
  - DRUPAL_TI_BEHAT_DRIVER="phantomjs"
  - DRUPAL_TI_BEHAT_BROWSER="firefox"
  - DRUPAL_TI_PHPUNIT_ARGS=""
  - DRUPAL_TI_COVERAGE="satooshi/php-coveralls:0.6.*"
  - DRUPAL_TI_COVERAGE_FILE="build/logs/clover.xml"
  - DRUPAL_TI_SIMPLETEST_COVERAGE="1"
  - DRUPAL_TI_SIMPLETEST_COVERAGE_GENERATE_BADGES="1"
  - DRUPAL_TI_GITHUB_EMAIL="legovaer@me.com"
  - DRUPAL_TI_GITHUB_NAME="Levi Govaerts"
  - secure: "a5Q0HryOsbYeP8o2o7+nwJIISG9wyN/VOFueb6Mz/ffoqnDKnptk+VNEyFb2MyksZ/aigyAGjAjWc1iAB200u+Q05IEt4rCuDSIFzH7fk6KO+2OmCa4W9i31hIjb9G9V67OgTzz/qDdHQEXKhLihS4EWyfEYOn8PII7FZ2pKAdw24osjybGCHb6SvZQgWZ6f/M7R+zSfbbt0UnY5SbGIw88Zp2Zw4VEmlTr5gIOCe74C0VZwJzRMK1YLwMpfSI8SRkIWJCM/Ihiw/VCxDpcE6w5ZCqJJtRcAeWDHrZnkPGpDXZp0IbB01c2bHtIExX3vqfmpLRXzIO+HVeQRPtKxFBtAcs0ZgrXij4o3VBBh6gigPhH1H8xtEMBoSluF/o5h9f2yyHRjalDrJOS/s0CzHs7KF5NhAgsFTleIzvlgeebix+WnCqHoBDd4xFEFh0jsSwlqvgQNi45EWg8g4kkVOuxA79X0LhVMW8d0+SHJRnODoC1PSiW6Kq1oL7wMAfdSqjkCWjdLpFDsTk74WXQ2AootkxH4L1rochtemSk2nuB2QUL8LBPIFj3+H4zqPfLvIOP46kQxICiPR80sQBhjpZn+IK/7Tr4jR3g0n8vV2pMe6iGE9mrR251XcJzx8hxPqQZBzNTnT2eP24JalfBXN06tMEN4NzBR+p9XD7ypSTg="

  matrix:
  - DRUPAL_TI_RUNNERS="simpletest"
  - TEST_VAR="NOTUPDATED"
mysql:
  database: drupal_travis_db
  username: root
  encoding: utf8
before_install:
- echo "We found $TEST_VAR"
- composer self-update
# Installing drupal_ti manually as my pull request hasn't been merged yet.
- mkdir -p "$HOME/.composer/vendor/bin"
- cd $HOME
- git clone --branch travis-add-coverage-support https://github.com/legovaer/drupal_ti
- cd drupal_ti/
- composer install
- ln -sf $HOME/drupal_ti/drupal-ti "$HOME/.composer/vendor/bin"
- git clone --branch 7.x-1.x https://git.drupal.org/project/$DRUPAL_TI_MODULE_NAME.git $TRAVIS_BUILD_DIR/$DRUPAL_TI_MODULE_NAME
- cd $TRAVIS_BUILD_DIR/$DRUPAL_TI_MODULE/tests
#- drupal-ti --include "$TRAVIS_BUILD_DIR/scheduler/drupal_ti/before/before_install.sh"
- drupal-ti before_install
install:
- drupal-ti install
before_script:
#- drupal-ti --include "$TRAVIS_BUILD_DIR/scheduler/drupal_ti/before/before_script.sh"
- drupal-ti before_script
script:
- drupal-ti script
after_script:
- drupal-ti after_script
notifications:
  email: false
  # tes